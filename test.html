<!doctype html>
<html lang="vi">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
        <link rel="icon" href="favicon.ico" type="image/x-icon" />
        <title>FAQs t·ª´ Google Sheets</title>
        <style>
            /* ƒê·ªãnh nghƒ©a bi·∫øn CSS cho Clean & Functional Minimalism */
            :root {
                --primary-text-color: #333; /* M√†u vƒÉn b·∫£n ch√≠nh d·ªãu h∆°n */
                --secondary-text-color: #555; /* M√†u vƒÉn b·∫£n ph·ª• */
                --background-color: #fff;
                --light-background-color: #f0f2f5; /* N·ªÅn nh·∫π nh√†ng h∆°n */
                --border-color: #ddd; /* Vi·ªÅn m·ªÅm m·∫°i h∆°n */
                --accent-color: #007bff; /* M√†u ƒëi·ªÉm nh·∫•n: Xanh d∆∞∆°ng nh·∫π nh√†ng */
                --accent-hover-color: #0056b3; /* M√†u ƒëi·ªÉm nh·∫•n khi hover */
                --highlight-color: #ffcc00; /* Gi·ªØ m√†u highlight t√¨m ki·∫øm */
                --font-family-primary: "Inter", "Segoe UI", sans-serif;
                --border-radius-soft: 4px; /* Bo g√≥c nh·∫π */
            }

            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }

            body {
                font-family: var(--font-family-primary);
                background-color: var(--background-color);
                color: var(--primary-text-color);
                padding: 40px 20px;
                line-height: 1.6; /* Line height h∆°i gi·∫£m ƒë·ªÉ g·ªçn g√†ng h∆°n */
            }

            .container {
                max-width: 900px;
                margin: 0 auto;
            }

            h1 {
                font-size: 3rem; /* Gi·∫£m k√≠ch th∆∞·ªõc h1 m·ªôt ch√∫t cho s·ª± tinh t·∫ø */
                font-weight: 800; /* V·∫´n ƒë·∫≠m nh∆∞ng kh√¥ng qu√° "bold" */
                text-align: center;
                margin-bottom: 40px;
                color: var(--primary-text-color);
                letter-spacing: -0.02em; /* Gi·∫£m kho·∫£ng c√°ch ch·ªØ */
            }

            .search-bar input {
                width: 100%;
                padding: 16px; /* Gi·∫£m padding m·ªôt ch√∫t */
                font-size: 1.05rem;
                border: 1px solid var(--border-color); /* Vi·ªÅn m·ªèng h∆°n */
                border-radius: var(--border-radius-soft); /* Bo g√≥c nh·∫π */
                outline: none;
                background-color: var(--background-color);
                margin-bottom: 30px;
                font-weight: 500; /* Gi·∫£m ƒë·ªô ƒë·∫≠m c·ªßa font */
                color: var(--primary-text-color);
                box-shadow: 0 1px 3px rgba(0,0,0,0.08); /* Th√™m box-shadow nh·∫π */
                transition: border-color 0.2s ease, box-shadow 0.2s ease;
            }
            .search-bar input:focus {
                border-color: var(--accent-color); /* Vi·ªÅn m√†u ƒëi·ªÉm nh·∫•n khi focus */
                box-shadow: 0 1px 6px rgba(0,0,0,0.12);
            }
            .search-bar input::placeholder {
                color: var(--secondary-text-color); /* M√†u placeholder */
                font-weight: 500;
            }

            .chip {
                display: inline-block;
                padding: 10px 16px;
                margin: 6px 6px; /* Kho·∫£ng c√°ch v·ª´a ph·∫£i */
                font-size: 0.9rem;
                font-weight: 600;
                border-radius: var(--border-radius-soft); /* Bo g√≥c nh·∫π */
                background-color: var(--light-background-color); /* N·ªÅn nh·∫π h∆°n */
                color: var(--primary-text-color);
                border: 1px solid var(--border-color); /* Vi·ªÅn m·ªÅm m·∫°i h∆°n */
                cursor: pointer;
                transition: all 0.2s ease;
                text-transform: none; /* B·ªè uppercase */
            }

            .chip:hover {
                background-color: #e0e6eb; /* M√†u hover nh·∫π h∆°n */
                border-color: var(--accent-color);
                color: var(--primary-text-color);
            }

            .chip.active {
                background-color: var(--accent-color); /* M√†u n·ªÅn ƒëi·ªÉm nh·∫•n khi active */
                color: var(--background-color); /* Ch·ªØ tr·∫Øng */
                border-color: var(--accent-color);
            }

            .category h2 {
                font-size: 1.6rem; /* Gi·∫£m k√≠ch th∆∞·ªõc h2 m·ªôt ch√∫t */
                font-weight: 700; /* V·∫´n ƒë·∫≠m */
                margin: 50px 0 20px; /* Kho·∫£ng c√°ch v·ª´a ph·∫£i */
                padding-left: 0;
                border-left: none;
                color: var(--primary-text-color);
                text-transform: none; /* B·ªè uppercase */
                letter-spacing: -0.01em;
            }

            .faq-item {
                border-top: 1px solid var(--border-color); /* Vi·ªÅn m·ªèng v√† m·ªÅm */
                padding: 20px 0; /* Padding v·ª´a ph·∫£i */
                transition: background-color 0.3s ease;
            }
            .category .faq-item:last-child {
                border-bottom: 1px solid var(--border-color);
            }
            .faq-item:hover {
                background-color: var(--light-background-color); /* Highlight nh·∫π khi hover */
            }

            .faq-question {
                font-size: 1.1rem; /* K√≠ch th∆∞·ªõc font v·ª´a ph·∫£i */
                font-weight: 600; /* V·ª´a ƒë·ªß ƒë·∫≠m */
                cursor: pointer;
                display: flex;
                align-items: center;
                color: var(--primary-text-color);
                transition: color 0.3s ease;
            }

            .faq-question::before {
                content: "‚ñ∂"; /* Bi·ªÉu t∆∞·ª£ng v·∫´n r√µ r√†ng */
                font-weight: bold;
                font-size: 1.2rem; /* K√≠ch th∆∞·ªõc icon v·ª´a ph·∫£i */
                margin-right: 12px; /* Kho·∫£ng c√°ch */
                color: var(--accent-color); /* Icon m√†u ƒëi·ªÉm nh·∫•n */
                transition: transform 0.3s ease;
            }

            .faq-question.active::before {
                content: "‚ñº";
                transform: rotate(0deg);
            }
            .faq-question.active {
                color: var(--accent-hover-color); /* M√†u h∆°i ƒë·∫≠m h∆°n khi active */
            }

            .faq-answer {
                max-height: 0;
                overflow: hidden;
                transition: max-height 0.4s ease-out;
                font-size: 0.95rem;
                color: var(--secondary-text-color);
                margin-top: 10px; /* Kho·∫£ng c√°ch nh·ªè h∆°n */
                padding-left: 28px; /* CƒÉn ch·ªânh v·ªõi c√¢u h·ªèi */
            }

            .faq-answer p {
                margin-top: 10px;
            }

            .copy-btn,
            .reply-copy {
                font-size: 0.8rem;
                padding: 8px 14px;
                background: var(--accent-color); /* M√†u ƒëi·ªÉm nh·∫•n */
                color: var(--background-color);
                border: none;
                cursor: pointer;
                margin-top: 12px;
                transition: background 0.3s ease;
                font-weight: 600;
                text-transform: none; /* B·ªè uppercase */
                border-radius: var(--border-radius-soft); /* Bo g√≥c nh·∫π */
            }

            .copy-btn:hover,
            .reply-copy:hover {
                background: var(--accent-hover-color); /* M√†u ƒë·∫≠m h∆°n khi hover */
            }

            .scroll-top {
                position: fixed;
                bottom: 25px;
                right: 25px;
                background-color: var(--primary-text-color);
                color: var(--background-color);
                border: none;
                padding: 12px 16px; /* K√≠ch th∆∞·ªõc v·ª´a ph·∫£i */
                font-size: 1.1rem;
                font-weight: 600;
                opacity: 0.9;
                cursor: pointer;
                display: none;
                border-radius: var(--border-radius-soft); /* Bo g√≥c nh·∫π */
                transition: all 0.3s ease;
                box-shadow: 0 2px 8px rgba(0,0,0,0.2); /* Shadow r√µ r√†ng h∆°n m·ªôt ch√∫t */
            }

            .scroll-top.visible {
                display: block;
            }
            .scroll-top:hover {
                opacity: 1;
                background-color: var(--accent-hover-color); /* M√†u accent khi hover */
            }


            .replies-container h2 {
                font-size: 1.6rem;
                font-weight: 700;
                margin: 50px 0 20px;
                color: var(--primary-text-color);
                text-transform: none;
                letter-spacing: -0.01em;
            }

            .reply-group {
                margin-bottom: 15px; /* Kho·∫£ng c√°ch gi·ªØa c√°c nh√≥m */
            }

            .reply-group h3 {
                font-size: 1.05rem;
                font-weight: 600;
                padding: 16px 20px;
                background: var(--light-background-color);
                color: var(--primary-text-color);
                cursor: pointer;
                position: relative;
                margin-bottom: 0;
                border: 1px solid var(--border-color);
                border-bottom: none;
                border-radius: var(--border-radius-soft) var(--border-radius-soft) 0 0; /* Bo g√≥c tr√™n */
                transition: background 0.2s ease, border-color 0.2s ease;
            }

            .reply-group h3:hover {
                background: #e0e6eb;
            }
            .reply-group h3.active {
                background-color: var(--accent-color); /* N·ªÅn m√†u accent khi active */
                color: var(--background-color); /* Ch·ªØ tr·∫Øng */
                border-color: var(--accent-color);
            }

            .reply-group h3::after {
                content: "+";
                position: absolute;
                right: 20px;
                font-size: 1.5rem;
                font-weight: 700;
                color: var(--accent-color); /* Icon m√†u ƒëi·ªÉm nh·∫•n */
                transition: color 0.3s ease;
            }
            .reply-group h3.active::after {
                content: "‚àí";
                color: var(--background-color); /* Icon tr·∫Øng khi active */
            }


            .reply-items {
                max-height: 0;
                overflow: hidden;
                transition: max-height 0.4s ease-out;
                background: var(--background-color);
                padding: 0 20px;
                border: 1px solid var(--border-color);
                border-top: none;
                border-radius: 0 0 var(--border-radius-soft) var(--border-radius-soft); /* Bo g√≥c d∆∞·ªõi */
            }

            .reply-item {
                border-top: 1px dashed #eee; /* Vi·ªÅn n√©t ƒë·ª©t nh·∫π nh√†ng */
                padding: 18px 0;
            }
            .reply-item:first-child {
                border-top: none;
            }


            .reply-text {
                font-size: 0.95rem;
                color: var(--secondary-text-color);
            }

            .highlight {
                background-color: var(--highlight-color);
                padding: 1px 0;
                border-radius: 2px; /* Highlight m·ªÅm m·∫°i h∆°n */
            }

            .error {
                color: var(--accent-color); /* M√†u error l√† m√†u accent */
                text-align: center;
                margin-top: 20px;
                font-weight: 600;
            }

            .hidden {
                display: none !important;
            }

            /* Responsive */
            @media (max-width: 600px) {
                h1 {
                    font-size: 2.2rem;
                    margin-bottom: 25px;
                }

                .category h2 {
                    font-size: 1.4rem;
                    margin-top: 35px;
                }

                .faq-question {
                    font-size: 0.95rem;
                }

                .faq-question::before {
                    font-size: 1.1rem;
                    margin-right: 8px;
                }

                .faq-answer,
                .reply-text {
                    font-size: 0.88rem;
                    padding-left: 20px;
                }

                .chip {
                    font-size: 0.8rem;
                    padding: 7px 12px;
                    margin: 4px 4px;
                }

                .copy-btn,
                .reply-copy {
                    padding: 6px 10px;
                    font-size: 0.75rem;
                }

                .replies-container h2 {
                    font-size: 1.4rem;
                    margin-top: 35px;
                }

                .reply-group h3 {
                    font-size: 0.95rem;
                    padding: 12px 15px;
                }

                .reply-group h3::after {
                    font-size: 1.3rem;
                }

                .reply-items {
                    padding: 0 15px;
                }

                .scroll-top {
                    padding: 10px 14px;
                    font-size: 1rem;
                    bottom: 15px;
                    right: 15px;
                }
            }
        </style>
    </head>
    <body>
        <div class="container">
            <h1>C√¢u H·ªèi Th∆∞·ªùng G·∫∑p</h1>
            <div class="search-bar">
                <input
                    type="text"
                    id="searchInput"
                    placeholder="T√¨m ki·∫øm c√¢u h·ªèi..." />
            </div>
            <div class="chips" id="chips-container"></div>
            <div id="faq-container"></div>
            <div class="replies-container">
                <h2>C√¢u tr·∫£ l·ªùi m·∫´u</h2>
                <div class="replies-list" id="replies-list"></div>
            </div>
            <div id="error-message" class="error"></div>
            <button id="scroll-top" class="scroll-top">üîù</button>
        </div>

        <script>
            const spreadsheetId =
                "1ZkmUGU8EzIKNAJ_-_zXTrZ2CyqzsE3GaDDzimwMhIPg";
            const apiKey = "AIzaSyB_3MXA6ysK_6OGSTKtnfwCfNTB8Ovpod8";
            const range = "FAQs!A2:C";
            let allFaqsData = []; // Bi·∫øn to√†n c·ª•c ƒë·ªÉ l∆∞u tr·ªØ t·∫•t c·∫£ d·ªØ li·ªáu FAQ ban ƒë·∫ßu

            async function fetchSheetData() {
                const url = `https://sheets.googleapis.com/v4/spreadsheets/${spreadsheetId}/values/${range}?key=${apiKey}`;
                const errorMessage = document.getElementById("error-message");

                try {
                    const response = await fetch(url);
                    if (!response.ok) {
                        const errorData = await response.json();
                        throw new Error(
                            `L·ªói ${response.status}: ${errorData.error.message}`
                        );
                    }
                    const data = await response.json();
                    if (!data.values || data.values.length === 0) {
                        errorMessage.textContent =
                            "Kh√¥ng t√¨m th·∫•y d·ªØ li·ªáu trong ph·∫°m vi FAQs!A2:C.";
                        return;
                    }
                    allFaqsData = data.values; // L∆∞u tr·ªØ d·ªØ li·ªáu g·ªëc
                    renderFAQ(allFaqsData);
                    errorMessage.textContent = "";
                } catch (error) {
                    errorMessage.textContent = error.message;
                    console.error("Chi ti·∫øt l·ªói:", error);
                }
            }

            function renderFAQ(values) {
                const faqContainer = document.getElementById("faq-container");
                const chipsContainer =
                    document.getElementById("chips-container");
                let categories = {};

                values.forEach(([category, question, answer]) => {
                    if (!categories[category]) categories[category] = [];
                    categories[category].push({ question, answer });
                });

                chipsContainer.innerHTML = ''; 

                const allChip = document.createElement("div");
                allChip.className = "chip all active";
                allChip.textContent = `T·∫•t c·∫£ (${values.length})`;
                allChip.dataset.category = "all";
                chipsContainer.appendChild(allChip);

                for (const category of Object.keys(categories)) {
                    const chip = document.createElement("div");
                    chip.className = `chip ${category
                        .toLowerCase()
                        .replace(/\s+/g, "")}`;
                    chip.textContent = `${category} (${categories[category].length})`;
                    chip.dataset.category = category
                        .toLowerCase()
                        .replace(/\s+/g, "");
                    chipsContainer.appendChild(chip);
                }
                
                faqContainer.innerHTML = '';

                for (const [category, items] of Object.entries(categories)) {
                    const categoryDiv = document.createElement("div");
                    const categoryId = category.toLowerCase().replace(/\s+/g, "");
                    categoryDiv.className = `category ${categoryId}`;
                    categoryDiv.innerHTML = `<h2 id="${categoryId}">${category} (${items.length})</h2>`;

                    items.forEach((item) => {
                        const faqItem = document.createElement("div");
                        faqItem.className = "faq-item";
                        faqItem.innerHTML = `
                        <div class="faq-question">${item.question}</div>
                        <div class="faq-answer">
                            <p>${item.answer}</p>
                            <button class="copy-btn">Copy</button>
                        </div>
                    `;
                        categoryDiv.appendChild(faqItem);
                    });

                    faqContainer.appendChild(categoryDiv);
                }

                document.querySelectorAll(".faq-question").forEach((item) => {
                    item.addEventListener("click", () => {
                        const answer = item.nextElementSibling;
                        const isActive = item.classList.contains("active");
                        document
                            .querySelectorAll(".faq-question")
                            .forEach((q) => {
                                q.classList.remove("active");
                                q.nextElementSibling.style.maxHeight = null;
                            });
                        if (!isActive) {
                            item.classList.add("active");
                            answer.style.maxHeight = answer.scrollHeight + "px";
                        }
                    });
                });

                document.querySelectorAll(".copy-btn").forEach((btn) => {
                    btn.addEventListener("click", () => {
                        const answerText =
                            btn.previousElementSibling.textContent;
                        navigator.clipboard.writeText(answerText).then(() => {
                            btn.textContent = "ƒê√£ copy!";
                            setTimeout(() => (btn.textContent = "Copy"), 2000);
                        });
                    });
                });

                const searchInput = document.getElementById("searchInput");
                let searchTimeout;
                searchInput.addEventListener("input", () => {
                    clearTimeout(searchTimeout);
                    searchTimeout = setTimeout(() => {
                        const query = searchInput.value.toLowerCase();
                        let totalMatches = 0;

                        document.querySelectorAll(".faq-item").forEach((item) => {
                            const questionEl = item.querySelector(".faq-question");
                            const answerEl = item.querySelector(".faq-answer p");
                            const originalQuestion = questionEl.textContent; 
                            const originalAnswer = answerEl.textContent; 
                            const question = originalQuestion.toLowerCase();
                            const answer = originalAnswer.toLowerCase();
                            const isMatch =
                                question.includes(query) || answer.includes(query);

                            item.classList.toggle("hidden", !isMatch);
                            if (isMatch) totalMatches++;

                            questionEl.innerHTML = originalQuestion;
                            answerEl.innerHTML = originalAnswer;

                            if (query) {
                                questionEl.innerHTML =
                                    questionEl.textContent.replace(
                                        new RegExp(query, "gi"),
                                        (match) =>
                                            `<span class="highlight">${match}</span>`
                                    );
                                answerEl.innerHTML = answerEl.textContent.replace(
                                    new RegExp(query, "gi"),
                                    (match) =>
                                        `<span class="highlight">${match}</span>`
                                );
                            }
                        });

                        document.querySelectorAll(".category").forEach((category) => {
                            const items = category.querySelectorAll(
                                ".faq-item:not(.hidden)"
                            );
                            // ·∫®n category n·∫øu kh√¥ng c√≥ m·ª•c n√†o kh·ªõp V√Ä c√≥ query t√¨m ki·∫øm
                            category.classList.toggle("hidden", items.length === 0 && query !== '');
                        });
                        
                        updateCounts(); // C·∫≠p nh·∫≠t s·ªë l∆∞·ª£ng d·ª±a tr√™n k·∫øt qu·∫£ t√¨m ki·∫øm
                    }, 300);
                });

                document.querySelectorAll(".chip").forEach((chip) => {
                    chip.addEventListener("click", () => {
                        document
                            .querySelectorAll(".chip")
                            .forEach((c) => c.classList.remove("active"));
                        chip.classList.add("active");
                        
                        const selectedCategory = chip.dataset.category;
                        
                        // ƒê·∫£m b·∫£o t·∫•t c·∫£ c√°c FAQ v√† Categories ƒë∆∞·ª£c hi·ªÉn th·ªã l·∫°i
                        updateAllVisibility();
                        
                        // X√≥a n·ªôi dung t√¨m ki·∫øm v√† highlight
                        searchInput.value = '';
                        document.querySelectorAll('.highlight').forEach(span => {
                            span.outerHTML = span.innerHTML; 
                        });

                        if (selectedCategory === "all") {
                            window.scrollTo({ top: 0, behavior: "smooth" });
                        } else {
                            const targetCategoryElement = document.getElementById(selectedCategory);
                            if (targetCategoryElement) {
                                targetCategoryElement.scrollIntoView({ behavior: "smooth", block: "start" });
                            }
                        }
                        
                        updateCounts(); // C·∫≠p nh·∫≠t l·∫°i s·ªë l∆∞·ª£ng sau khi chip ƒë∆∞·ª£c click
                    });
                });

                function updateAllVisibility() {
                    // Hi·ªÉn th·ªã t·∫•t c·∫£ categories v√† faq items
                    document.querySelectorAll(".category").forEach(category => {
                        category.classList.remove("hidden");
                        category.querySelectorAll(".faq-item").forEach(item => {
                            item.classList.remove("hidden");
                        });
                    });
                }

                function updateCounts() {
                    const query = searchInput.value.toLowerCase();
                    let totalVisibleFaqs = 0;

                    document.querySelectorAll(".category").forEach(category => {
                        const categoryName = category.querySelector("h2").textContent.split(" (")[0];
                        let count = 0;
                        if (query) { 
                            // N·∫øu c√≥ query t√¨m ki·∫øm, ƒë·∫øm c√°c m·ª•c kh√¥ng b·ªã ·∫©n
                            count = category.querySelectorAll(".faq-item:not(.hidden)").length;
                        } else { 
                            // N·∫øu kh√¥ng c√≥ query, ƒë·∫øm t·ªïng s·ªë m·ª•c ban ƒë·∫ßu c·ªßa category ƒë√≥ t·ª´ allFaqsData
                            count = allFaqsData.filter(faq => 
                                faq[0].toLowerCase().replace(/\s+/g, "") === category.id 
                            ).length;
                        }
                        category.querySelector("h2").textContent = `${categoryName} (${count})`;
                        totalVisibleFaqs += count;
                    });

                    document.querySelectorAll(".chip:not(.all)").forEach(chip => {
                        const categoryClass = chip.dataset.category;
                        // L·∫•y s·ªë l∆∞·ª£ng t·ª´ ti√™u ƒë·ªÅ H2 t∆∞∆°ng ·ª©ng (ƒë√£ ƒë∆∞·ª£c c·∫≠p nh·∫≠t b·ªüi logic tr√™n)
                        const matchingCategoryH2 = document.getElementById(categoryClass)?.querySelector("h2");
                        let count = 0;
                        if (matchingCategoryH2) {
                            const match = matchingCategoryH2.textContent.match(/\((\d+)\)/);
                            if (match && match[1]) {
                                count = parseInt(match[1]);
                            }
                        }
                        const chipText = chip.textContent.split(" (")[0];
                        chip.textContent = `${chipText} (${count})`;
                    });

                    const allChip = document.querySelector(".chip.all");
                    if (query) {
                        allChip.textContent = `T·∫•t c·∫£ (${totalVisibleFaqs})`;
                    } else {
                         allChip.textContent = `T·∫•t c·∫£ (${allFaqsData.length})`;
                    }
                }


                const scrollTopBtn = document.getElementById("scroll-top");
                window.addEventListener("scroll", () => {
                    scrollTopBtn.classList.toggle(
                        "visible",
                        window.scrollY > 200
                    );
                });
                scrollTopBtn.addEventListener("click", () => {
                    window.scrollTo({ top: 0, behavior: "smooth" });
                });
            }
            async function fetchRepliesData() {
                const url = `https://sheets.googleapis.com/v4/spreadsheets/${spreadsheetId}/values/Replies!A1:A?key=${apiKey}`;
                try {
                    const response = await fetch(url);
                    if (!response.ok) throw new Error(`L·ªói ${response.status}`);
                    const data = await response.json();
                    if (data.values && data.values.length)
                        renderReplies(data.values);
                } catch (error) {
                    console.error("L·ªói fetch Replies:", error);
                }
            }

            function renderReplies(values) {
                const repliesList = document.getElementById("replies-list");
                repliesList.innerHTML = "";
                let currentGroup = null;
                let replies = [];

                values.forEach((row) => {
                    const text = row[0];
                    if (!text) return;

                    if (text.trim().startsWith("!")) {
                        if (currentGroup && replies.length) {
                            addRepliesGroup(
                                repliesList,
                                currentGroup.slice(1),
                                replies
                            );
                        }
                        currentGroup = text;
                        replies = [];
                    } else if (currentGroup) {
                        replies.push(text);
                    }
                });

                if (currentGroup && replies.length) {
                    addRepliesGroup(
                        repliesList,
                        currentGroup.slice(1),
                        replies
                    );
                }

                document
                    .querySelectorAll(".reply-group h3")
                    .forEach((header) => {
                        header.addEventListener("click", () => {
                            const items = header.nextElementSibling;
                            const isActive =
                                header.classList.contains("active");

                            document
                                .querySelectorAll(".reply-group h3")
                                .forEach((h) => {
                                    h.classList.remove("active");
                                    h.nextElementSibling.style.maxHeight = null;
                                });

                            if (!isActive) {
                                header.classList.add("active");
                                items.style.maxHeight =
                                    items.scrollHeight + "px";
                            }
                        });
                    });
            }

            function addRepliesGroup(container, title, replies) {
                const group = document.createElement("div");
                group.className = "reply-group";
                group.innerHTML = `<h3>${title}</h3><div class="reply-items"></div>`;

                const itemsContainer = group.querySelector(".reply-items");
                replies.forEach((reply) => {
                    const item = document.createElement("div");
                    item.className = "reply-item";
                    item.innerHTML = `
                    <span class="reply-text">${reply}</span>
                    <button class="reply-copy">Copy</button>
                `;
                    itemsContainer.appendChild(item);
                });

                container.appendChild(group);

                group.querySelectorAll(".reply-copy").forEach((btn) => {
                    btn.addEventListener("click", () => {
                        const text = btn.previousElementSibling.textContent;
                        navigator.clipboard.writeText(text).then(() => {
                            btn.textContent = "ƒê√£ copy!";
                            setTimeout(() => (btn.textContent = "Copy"), 2000);
                        });
                    });
                });
            }
            document.addEventListener("DOMContentLoaded", () => {
                fetchSheetData();
                fetchRepliesData();
            });
        </script>
    </body>
</html>
